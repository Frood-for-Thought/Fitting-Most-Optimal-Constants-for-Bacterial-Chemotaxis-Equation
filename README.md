# Fitting-Most-Optimal-Constants-for-Bacterial-Chemotaxis-Equation
Using Data Analysis to filter out a list of potential constants per position for use in a stochastic run and tumble algorithm.

## Programs
Each Folder has a file, "Program Info.txt", to describe all files and their uses in the project.

## Process
### Diffusion Folder
- Find_Diff_RawData_Program.m calls the "Calc_D_Per_r_Deme_Function.m" program to generate
several distance data points using a run-and-tumble algorithm.
- input_parameters.xlsx are used by initializing parameters in the "Find_Diff_RawData_Program.m".
- The output of "Find_Diff_RawData_Program.m" generates the file,
"1.000_to_1.200_Diff_Conts_30001_DataPts_1000_Time.xlsx" which gives a list of 21 diffusion
constants from 1.00 to 1.20 with 30001 datapoints each.
- creating_analyzing_df.ipynb creates a dataframe out of the file "1.000_to_1.200_Diff_Conts_30001_DataPts_1000_Time.xlsx".
The diffusion data is grouped per diffusion constant and made into histograms, 
which then are cleaned to remove outliers or means which are outside a confidence interval.
The (unitless) diffusion constant accepted is one which has the lowest Bhattacharyya Distance from the theoretical 
Gaussian diffusion distribution, (D = 112 microns/s^2, t=1000s), and one which passes the Shapiro-Wilk test.
- creating_analyzing_df_table.py is a python file which generates the same table as "creating_analyzing_df.ipynb", but
graphing and plotting are further done in the "creating_analyzing_df.ipynb" file.

### Drift Velocity Folder
- The program to execute in order to generate the data to analyze is "Find_Alpha_RawData_Program.m". 
The data includes a list of potential alpha values per position and several velocity datappoints
from running a Monte Carlo run-and-tumble simulation.
- input_parameters.xlsx are used by initializing parameters in the "Find_Alpha_RawData_Program.m",
and "Tumble_Angle_Function.m" randomly finds the next angle the bacteria tumbles towards using the 
tumble angle distribution it was given for the run-and-tumble algorithm.
- Find_Alpha_RawData_Program.m uses the results of "Calc_V_Per_Alpha_Deme_Function.m" and 
"Calc_V_Per_Alpha_Deme_moreIter_Function" to calculate raw data points for multiple alpha 
values per deme and records everything into tables which contain the deme position, 
a range of alpha values, and a range of recorded velocities for the alpha values.
- The Python program "fit_alpha_constant" takes the raw data generated, cleans the outliers, 
then calculates the alpha value with the drift velocity closest to the theoretical, 
and puts all the results into the file "closest_alpha_const.csv".
- alpha_MaxC_60000_Grad_000405_CurveFit.m is the MATLAB program used for polynomial regressive analysis using
the file "closest_alpha_const.csv", which exports the polynomial curve fit results into the file
"alpha_values_MaxC_60000_Grad_0.000405_curve_fit".
- Run_and_Tumble_Algorithm_Temp_Stim_Chemotaxis.m reproduces the run-and-tumble chemotaxis migration of bacteria
as they are drawn towards a food sources, but is now reworked to include the alpha values curve fit 
from "alpha_values_MaxC_60000_Grad_0.000405_curve_fit".

### Data Analysis Folder
plotting.ipynb generates plots using the following data:
- The "input_parameters" file is used by the MATLAB programs to run the simulations.  It contains information on the
food gradient, theoretical drift velocity, run speed, and the bacteria receptor activity to the attractant (food).
- alpha_values_MaxC_60000_Grad_0.000405_curve_fit are the final alpha values by analyzing all the raw
data generated by "Calc_V_Per_Alpha_Deme_moreIter_Function".  
- The file alpha_values_MaxC_60000_Grad_0.000405_curve_fit are the final alpha values calculated by "fit_alpha_constant.py".
It also contains a polynomial regressive analysis curve fit created by "alpha_MaxC_60000_Grad_000405_CurveFit.m".
- pos_v_time_MaxC_60000_Grad_0.000405 files are plots of position vs time to be analyzed in the "plotting" file.
The pos_v_time files were outputs from the "Run_and_Tumble_Algorithm_Temp_Stim_Chemotaxis" file in the Drift Velocity Folder.